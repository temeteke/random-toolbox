<!DOCTYPE html>
<html lang="ja">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="ランダム生成ツールボックス">
    <meta name="theme-color" content="#4CAF50">
    <title>Random Toolbox</title>
    <link rel="stylesheet" href="style.css">
    <link rel="manifest" href="manifest.json">
    <link rel="icon" type="image/png" href="icon-192.png">
</head>
<body>
    <div x-data="settingsPanel()">
        <!-- 設定トグルボタン -->
        <button class="settings-toggle" @click="showSettings = !showSettings">
            ⚙️
        </button>

        <!-- 設定パネル -->
        <div x-show="showSettings" class="settings-panel" @click.away="showSettings = false" style="display: none;" x-transition>
        <h3 style="margin-bottom: 20px;">設定</h3>

        <div class="settings-section">
            <h4>テーマ</h4>
            <button @click="changeTheme('light')" class="settings-btn" :class="{ 'active': currentTheme === 'light' }">
                ☀️ ライト
            </button>
            <button @click="changeTheme('dark')" class="settings-btn" :class="{ 'active': currentTheme === 'dark' }">
                🌙 ダーク
            </button>
            <button @click="changeTheme('auto')" class="settings-btn" :class="{ 'active': currentTheme === 'auto' }">
                🔄 自動
            </button>
        </div>

        <div class="settings-section">
            <h4>音声読み上げ</h4>
            <button @click="toggleSpeech()" class="settings-btn" :class="{ 'active': speechEnabled }">
                <span x-text="speechEnabled ? '🔊 ON' : '🔇 OFF'"></span>
            </button>
        </div>

        <div class="settings-section">
            <h4>データ管理</h4>
            <button @click="exportData()" class="settings-btn">
                📥 エクスポート (JSON)
            </button>
            <button @click="exportCSV()" class="settings-btn">
                📥 エクスポート (CSV)
            </button>
            <button @click="importData()" class="settings-btn">
                📤 インポート
            </button>
            <button @click="clearAllData()" class="settings-btn" style="color: #f44336;">
                🗑️ 全データ削除
            </button>
        </div>
    </div>
    </div>

    <input type="file" id="importFileInput" accept=".json" style="display: none;">

    <div x-data="tabManager()">
        <!-- ハンバーガーメニューボタン -->
        <button class="menu-toggle" @click="toggleMenu()" x-show="!showMenu" x-transition>
            ☰
        </button>

        <!-- メニューオーバーレイ -->
        <div class="menu-overlay" x-show="showMenu" @click="closeMenu()" x-transition style="display: none;"></div>

        <!-- サイドバーメニュー -->
        <nav class="sidebar-menu" x-show="showMenu" x-transition style="display: none;">
        <div class="menu-header">
            <h2>🎲 ツール一覧</h2>
            <button class="menu-close" @click="closeMenu()">✕</button>
        </div>

        <div class="menu-categories">
            <!-- 基本ツール -->
            <div class="menu-category">
                <div class="category-header">🎲 基本ツール</div>
                <button @click="switchTab('number')" :class="{ 'menu-item': true, 'active': activeTab === 'number' }">
                    🔢 数字生成
                </button>
                <button @click="switchTab('list')" :class="{ 'menu-item': true, 'active': activeTab === 'list' }">
                    📋 リスト選択
                </button>
                <button @click="switchTab('decision')" :class="{ 'menu-item': true, 'active': activeTab === 'decision' }">
                    🎯 決定ツール
                </button>
                <button @click="switchTab('shuffle')" :class="{ 'menu-item': true, 'active': activeTab === 'shuffle' }">
                    🔀 シャッフル
                </button>
            </div>

            <!-- ゲームツール -->
            <div class="menu-category">
                <div class="category-header">🎮 ゲームツール</div>
                <button @click="switchTab('roulette')" :class="{ 'menu-item': true, 'active': activeTab === 'roulette' }">
                    🎰 ルーレット
                </button>
                <button @click="switchTab('dice')" :class="{ 'menu-item': true, 'active': activeTab === 'dice' }">
                    🎲 サイコロ
                </button>
                <button @click="switchTab('card')" :class="{ 'menu-item': true, 'active': activeTab === 'card' }">
                    🃏 カード
                </button>
                <button @click="switchTab('coin')" :class="{ 'menu-item': true, 'active': activeTab === 'coin' }">
                    🪙 コイントス
                </button>
                <button @click="switchTab('bingo')" :class="{ 'menu-item': true, 'active': activeTab === 'bingo' }">
                    🎬 ビンゴ
                </button>
                <button @click="switchTab('lottery')" :class="{ 'menu-item': true, 'active': activeTab === 'lottery' }">
                    🎊 抽選ボックス
                </button>
            </div>

            <!-- クリエイティブ -->
            <div class="menu-category">
                <div class="category-header">🎨 クリエイティブ</div>
                <button @click="switchTab('color')" :class="{ 'menu-item': true, 'active': activeTab === 'color' }">
                    🎨 カラー
                </button>
                <button @click="switchTab('gradient')" :class="{ 'menu-item': true, 'active': activeTab === 'gradient' }">
                    🌈 グラデーション
                </button>
                <button @click="switchTab('lorem')" :class="{ 'menu-item': true, 'active': activeTab === 'lorem' }">
                    📝 ダミーテキスト
                </button>
                <button @click="switchTab('password')" :class="{ 'menu-item': true, 'active': activeTab === 'password' }">
                    🔐 パスワード
                </button>
            </div>

            <!-- データ管理 -->
            <div class="menu-category">
                <div class="category-header">📊 データ管理</div>
                <button @click="switchTab('weighted')" :class="{ 'menu-item': true, 'active': activeTab === 'weighted' }">
                    ⚖️ 重み付き抽選
                </button>
                <button @click="switchTab('task')" :class="{ 'menu-item': true, 'active': activeTab === 'task' }">
                    ✏️ タスクピッカー
                </button>
            </div>

            <!-- 生活ツール -->
            <div class="menu-category">
                <div class="category-header">🍔 生活ツール</div>
                <button @click="switchTab('menu')" :class="{ 'menu-item': true, 'active': activeTab === 'menu' }">
                    🍔 メニュー提案
                </button>
                <button @click="switchTab('name')" :class="{ 'menu-item': true, 'active': activeTab === 'name' }">
                    📛 名前生成
                </button>
            </div>

            <!-- 日時・位置 -->
            <div class="menu-category">
                <div class="category-header">📅 日時・位置</div>
                <button @click="switchTab('date')" :class="{ 'menu-item': true, 'active': activeTab === 'date' }">
                    📅 ランダム日付
                </button>
                <button @click="switchTab('timer')" :class="{ 'menu-item': true, 'active': activeTab === 'timer' }">
                    ⏱️ ランダムタイマー
                </button>
                <button @click="switchTab('coordinate')" :class="{ 'menu-item': true, 'active': activeTab === 'coordinate' }">
                    🗺️ ランダム座標
                </button>
            </div>
        </div>
    </nav>

    <div class="container">
        <header>
            <h1>🎲 Random Toolbox</h1>
            <p class="subtitle">ランダム生成ツール</p>
        </header>

        <main>
            <div class="card">
                <!-- 現在のツール表示 -->
                <div class="current-tool">
                    <span class="tool-icon" x-text="getToolIcon()"></span>
                    <span class="tool-name" x-text="getToolName()"></span>
                </div>

                <!-- 数字生成タブ -->
                <div x-show="activeTab === 'number'" class="tab-content" x-data="numberGenerator()">
                    <div class="input-group">
                        <label for="min">最小値:</label>
                        <input type="number" x-model="min" @keypress.enter="generate()" class="number-input">
                    </div>

                    <div class="input-group">
                        <label for="max">最大値:</label>
                        <input type="number" x-model="max" @keypress.enter="generate()" class="number-input">
                    </div>

                    <button @click="generate()" class="generate-btn">
                        乱数を生成
                    </button>

                    <div class="result">
                        <div class="result-label">生成された数字</div>
                        <div class="random-number" :class="{ 'fade-in': animating }" x-text="result ?? '?'"></div>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number" x-text="item.number"></span>
                                    <span class="time" x-text="item.range + ' - ' + item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- リスト選択タブ -->
                <div x-show="activeTab === 'list'" class="tab-content" x-data="listSelector()">
                    <div class="input-group">
                        <label>リスト項目（1行に1つ）:</label>
                        <textarea x-model="listItems" class="list-input" rows="8" placeholder="りんご&#10;バナナ&#10;みかん&#10;ぶどう&#10;いちご"></textarea>
                    </div>

                    <button @click="select()" class="generate-btn">
                        ランダムに選択
                    </button>

                    <div class="result">
                        <div class="result-label">選ばれた項目</div>
                        <div class="random-number" :class="{ 'fade-in': animating }" x-text="result ?? '?'"></div>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number" x-text="item.item"></span>
                                    <span class="time" x-text="item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- ルーレットタブ -->
                <div x-show="activeTab === 'roulette'" class="tab-content" x-data="roulette()">
                    <div class="input-group">
                        <label>ルーレット項目（1行に1つ）:</label>
                        <textarea x-model="items" @input="saveItems()" class="list-input" rows="8" placeholder="選択肢1&#10;選択肢2&#10;選択肢3&#10;選択肢4&#10;選択肢5"></textarea>
                    </div>

                    <button @click="spin()" class="generate-btn" :disabled="isSpinning">
                        🎰 ルーレットを回す
                    </button>

                    <div class="roulette-container">
                        <div class="roulette-wheel" :style="`transform: rotate(${wheelRotation}deg); transition: ${isSpinning ? 'transform 4s cubic-bezier(0.25, 0.1, 0.25, 1)' : 'none'};`">
                            <div class="roulette-pointer">▼</div>
                            <div x-html="buildRouletteWheel()"></div>
                        </div>
                    </div>

                    <div class="result" x-show="winner" x-transition>
                        <div class="result-label">当たり!</div>
                        <div class="random-number" x-text="winner"></div>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number" x-text="item.item"></span>
                                    <span class="time" x-text="item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- サイコロタブ -->
                <div x-show="activeTab === 'dice'" class="tab-content" x-data="diceRoller()">
                    <div class="input-group">
                        <label>サイコロの数:</label>
                        <input type="number" x-model="count" min="1" max="10" class="number-input">
                    </div>

                    <div class="input-group">
                        <label>サイコロの種類:</label>
                        <select x-model="sides" class="number-input">
                            <option value="6">6面ダイス (D6)</option>
                            <option value="8">8面ダイス (D8)</option>
                            <option value="10">10面ダイス (D10)</option>
                            <option value="12">12面ダイス (D12)</option>
                            <option value="20">20面ダイス (D20)</option>
                            <option value="100">100面ダイス (D100)</option>
                        </select>
                    </div>

                    <button @click="roll()" class="generate-btn">
                        🎲 サイコロを振る
                    </button>

                    <div class="result">
                        <div class="result-label">結果</div>
                        <div class="dice-values" :class="{ 'fade-in': animating }" x-text="displayValues"></div>
                        <div class="dice-total" x-text="values.length > 0 ? `合計: ${total}` : '合計: -'"></div>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number" x-text="item.result"></span>
                                    <span class="time" x-text="item.config + ' - ' + item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- カードドロータブ -->
                <div x-show="activeTab === 'card'" class="tab-content" x-data="cardDraw()">
                    <div class="input-group">
                        <label>引く枚数:</label>
                        <input type="number" x-model="cardCount" min="1" max="52" class="number-input">
                    </div>

                    <div class="input-group">
                        <label>
                            <input type="checkbox" x-model="includeJoker">
                            ジョーカーを含む (2枚)
                        </label>
                    </div>

                    <button @click="draw()" class="generate-btn">
                        🃏 カードを引く
                    </button>

                    <div class="result">
                        <div class="result-label">引いたカード</div>
                        <div class="card-display" :class="{ 'fade-in': animating }" x-text="displayCards"></div>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number" x-text="item.cards"></span>
                                    <span class="time" x-text="item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- カラーピッカータブ -->
                <div x-show="activeTab === 'color'" class="tab-content" x-data="colorPicker()">
                    <div class="input-group">
                        <label>生成タイプ:</label>
                        <select x-model="colorType" class="number-input">
                            <option value="single">単色</option>
                            <option value="palette">カラーパレット (5色)</option>
                        </select>
                    </div>

                    <button @click="generate()" class="generate-btn">
                        🎨 色を生成
                    </button>

                    <div class="result">
                        <div class="result-label">生成された色</div>
                        <div class="color-display" :class="{ 'fade-in': animating }">
                            <template x-if="generatedColor">
                                <div class="single-color">
                                    <div class="color-box" :style="`background-color: ${generatedColor.hex};`" @click="copyColor(generatedColor.hex)"></div>
                                    <div class="color-info">
                                        <div x-text="generatedColor.hex"></div>
                                        <div x-text="generatedColor.rgb"></div>
                                    </div>
                                </div>
                            </template>
                            <template x-if="generatedPalette.length > 0">
                                <div class="color-palette">
                                    <template x-for="color in generatedPalette" :key="color">
                                        <div class="palette-color">
                                            <div class="color-box" :style="`background-color: ${color};`" @click="copyColor(color)"></div>
                                            <div class="color-code" x-text="color"></div>
                                        </div>
                                    </template>
                                </div>
                            </template>
                        </div>
                    </div>

                    <div class="history-section">
                        <h3>お気に入り</h3>
                        <button @click="clearHistory()" class="clear-btn">クリア</button>
                        <ul class="history-list color-history">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <template x-if="item.type === 'single'">
                                        <div>
                                            <span class="color-box-small" :style="`background-color: ${item.color};`"></span>
                                            <span x-text="item.color"></span>
                                            <span class="time" x-text="item.time"></span>
                                        </div>
                                    </template>
                                    <template x-if="item.type === 'palette'">
                                        <div>
                                            <template x-for="color in item.colors" :key="color">
                                                <span class="color-box-small" :style="`background-color: ${color};`"></span>
                                            </template>
                                            <span class="time" x-text="item.time"></span>
                                        </div>
                                    </template>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- 日付ランダマイザータブ -->
                <div x-show="activeTab === 'date'" class="tab-content" x-data="dateRandomizer()">
                    <div class="input-group">
                        <label>開始日:</label>
                        <input type="date" x-model="startDate" class="number-input">
                    </div>

                    <div class="input-group">
                        <label>終了日:</label>
                        <input type="date" x-model="endDate" class="number-input">
                    </div>

                    <div class="input-group">
                        <label>曜日フィルター:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" @change="toggleDay(0)" :checked="isDaySelected(0)"> 日</label>
                            <label><input type="checkbox" @change="toggleDay(1)" :checked="isDaySelected(1)"> 月</label>
                            <label><input type="checkbox" @change="toggleDay(2)" :checked="isDaySelected(2)"> 火</label>
                            <label><input type="checkbox" @change="toggleDay(3)" :checked="isDaySelected(3)"> 水</label>
                            <label><input type="checkbox" @change="toggleDay(4)" :checked="isDaySelected(4)"> 木</label>
                            <label><input type="checkbox" @change="toggleDay(5)" :checked="isDaySelected(5)"> 金</label>
                            <label><input type="checkbox" @change="toggleDay(6)" :checked="isDaySelected(6)"> 土</label>
                        </div>
                    </div>

                    <button @click="generate()" class="generate-btn">
                        📅 日付を生成
                    </button>

                    <div class="result">
                        <div class="result-label">生成された日付</div>
                        <div class="random-number" :class="{ 'fade-in': animating }" x-text="randomDate || '?'"></div>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number" x-text="item.date"></span>
                                    <span class="time" x-text="item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- パスワード生成器タブ -->
                <div x-show="activeTab === 'password'" class="tab-content" x-data="passwordGenerator()">
                    <div class="input-group">
                        <label>文字数: <span x-text="length"></span></label>
                        <input type="range" x-model="length" min="8" max="128" class="slider">
                    </div>

                    <div class="input-group">
                        <label>文字種別:</label>
                        <div class="checkbox-group">
                            <label><input type="checkbox" x-model="includeUppercase"> 大文字 (A-Z)</label>
                            <label><input type="checkbox" x-model="includeLowercase"> 小文字 (a-z)</label>
                            <label><input type="checkbox" x-model="includeNumbers"> 数字 (0-9)</label>
                            <label><input type="checkbox" x-model="includeSymbols"> 記号 (!@#$%...)</label>
                        </div>
                    </div>

                    <button @click="generate()" class="generate-btn">
                        ✨ パスワードを生成
                    </button>

                    <div class="result">
                        <div class="result-label">生成されたパスワード</div>
                        <div class="password-display" :class="{ 'fade-in': animating }" x-text="generatedPassword || '?'"></div>
                        <button @click="copyPassword()" class="copy-btn" x-show="generatedPassword" x-transition>📋 コピー</button>
                        <div class="password-strength" x-show="strength">
                            <div class="strength-bar">
                                <div class="strength-fill" :style="`width: ${strengthPercentage}%; background-color: ${strength?.color};`"></div>
                            </div>
                            <div class="strength-label" x-text="strength?.label" :style="`color: ${strength?.color};`"></div>
                        </div>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number" x-text="item.password"></span>
                                    <span class="time" x-text="item.config + ' - ' + item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- 決定ツールタブ -->
                <div x-show="activeTab === 'decision'" class="tab-content" x-data="decisionTool()">
                    <div class="input-group">
                        <label>選択肢（1行に1つ、2〜5個）:</label>
                        <textarea x-model="options" @input="saveOptions()" class="list-input" rows="5" placeholder="はい&#10;いいえ"></textarea>
                    </div>

                    <button @click="makeDecision()" class="generate-btn">
                        🎯 決定する
                    </button>

                    <div class="result">
                        <div class="result-label">決定!</div>
                        <div class="random-number" :class="{ 'fade-in': animating }" x-text="decision || '?'"></div>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number" x-text="item.decision"></span>
                                    <span class="time" x-text="'(' + item.options + ') - ' + item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- シャッフラータブ -->
                <div x-show="activeTab === 'shuffle'" class="tab-content" x-data="shuffler()">
                    <div class="input-group">
                        <label>シャッフルするリスト（1行に1つ）:</label>
                        <textarea x-model="items" @input="saveItems()" class="list-input" rows="8" placeholder="項目1&#10;項目2&#10;項目3&#10;項目4&#10;項目5"></textarea>
                    </div>

                    <div class="input-group">
                        <label>グループ数 (0 = 分割なし):</label>
                        <input type="number" x-model="groupCount" min="0" max="20" class="number-input">
                    </div>

                    <button @click="shuffle()" class="generate-btn">
                        🔀 シャッフル
                    </button>

                    <div class="result" x-show="shuffledResult">
                        <div class="result-label">シャッフル結果</div>
                        <div class="shuffled-list" :class="{ 'fade-in': animating }">
                            <template x-if="shuffledResult?.type === 'list'">
                                <ol>
                                    <template x-for="item in shuffledResult.items" :key="item">
                                        <li x-text="item"></li>
                                    </template>
                                </ol>
                            </template>
                            <template x-if="shuffledResult?.type === 'groups'">
                                <div>
                                    <template x-for="(group, index) in shuffledResult.groups" :key="index">
                                        <div class="group">
                                            <h4 x-text="'グループ ' + (index + 1)"></h4>
                                            <ul>
                                                <template x-for="item in group" :key="item">
                                                    <li x-text="item"></li>
                                                </template>
                                            </ul>
                                        </div>
                                    </template>
                                </div>
                            </template>
                        </div>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number" x-text="item.result"></span>
                                    <span class="time" x-text="item.config + ' - ' + item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- 抽選ボックスタブ -->
                <div x-show="activeTab === 'lottery'" class="tab-content" x-data="lotteryBox()">
                    <div class="input-group">
                        <label>抽選項目（1行に1つ）:</label>
                        <textarea x-model="items" @input="saveItems()" class="list-input" rows="8" placeholder="参加者1&#10;参加者2&#10;参加者3&#10;参加者4&#10;参加者5"></textarea>
                    </div>

                    <button @click="start()" class="generate-btn" x-show="!isStarted">
                        🎊 抽選を開始
                    </button>

                    <button @click="draw()" class="generate-btn" x-show="isStarted && !isComplete">
                        🎁 次を引く
                    </button>

                    <button @click="reset()" class="secondary-btn" x-show="isStarted">
                        🔄 リセット
                    </button>

                    <div class="result" x-show="currentWinner" x-transition>
                        <div class="result-label">当選!</div>
                        <div class="random-number" :class="{ 'fade-in': animating }" x-text="currentWinner"></div>
                        <div class="lottery-remaining" x-text="'残り: ' + remaining + '項目'"></div>
                    </div>

                    <div class="history-section">
                        <h3>抽選結果</h3>
                        <button @click="clearHistory()" class="clear-btn">クリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number" x-text="item.winner"></span>
                                    <span class="time" x-text="item.order + ' - ' + item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>
                <!-- コイントスタブ -->
                <div x-show="activeTab === 'coin'" class="tab-content" x-data="coinFlip()">
                    <button @click="flip()" class="generate-btn" :disabled="isFlipping">
                        🪙 コインを投げる
                    </button>

                    <div class="result">
                        <div class="result-label">結果</div>
                        <div class="coin-result" :class="{ 'fade-in': animating }" x-text="result || '?'"></div>
                    </div>

                    <div class="coin-stats">
                        <div class="stat-item">
                            <div class="stat-value" x-text="stats.heads"></div>
                            <div class="stat-label">表 (<span x-text="headsPercentage"></span>%)</div>
                        </div>
                        <div class="stat-item">
                            <div class="stat-value" x-text="stats.tails"></div>
                            <div class="stat-label">裏 (<span x-text="tailsPercentage"></span>%)</div>
                        </div>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number" x-text="item.result"></span>
                                    <span class="time" x-text="'#' + item.flipNumber + ' - ' + item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- ランダムメニュー提案タブ -->
                <div x-show="activeTab === 'menu'" class="tab-content" x-data="menuSuggester()">
                    <div class="input-group">
                        <label>カテゴリー:</label>
                        <select x-model="selectedCategory" @change="updateRange()" class="number-input">
                            <option value="all">全て</option>
                            <option value="japanese">和食</option>
                            <option value="western">洋食</option>
                            <option value="chinese">中華</option>
                            <option value="fast">ファストフード</option>
                            <option value="healthy">ヘルシー</option>
                            <option value="custom">カスタム</option>
                        </select>
                    </div>

                    <div class="input-group" x-show="selectedCategory === 'custom'">
                        <label>カスタムメニュー（1行に1つ）:</label>
                        <textarea x-model="customItems" @input="saveCustomItems()" class="list-input" rows="6" placeholder="カスタムメニュー1&#10;カスタムメニュー2&#10;カスタムメニュー3"></textarea>
                    </div>

                    <div class="input-group">
                        <label>予算範囲:</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="number" x-model="minBudget" placeholder="最小" class="number-input">
                            <input type="number" x-model="maxBudget" placeholder="最大" class="number-input">
                        </div>
                    </div>

                    <button @click="suggest()" class="generate-btn">
                        🍔 メニューを提案
                    </button>

                    <div class="result" x-show="result">
                        <div class="result-label">今日のメニュー</div>
                        <div class="random-number" :class="{ 'fade-in': animating }" x-text="result?.menu"></div>
                        <div style="margin-top: 10px; font-size: 1.2em; color: #666;" x-text="result ? '予算: ¥' + result.budget : ''"></div>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number" x-text="item.menu + ' (¥' + item.budget + ')'"></span>
                                    <span class="time" x-text="item.category + ' - ' + item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- 名前ジェネレータータブ -->
                <div x-show="activeTab === 'name'" class="tab-content" x-data="nameGenerator()">
                    <div class="input-group">
                        <label>種類:</label>
                        <select x-model="nameType" class="number-input">
                            <option value="japanese">日本語名</option>
                            <option value="english">英語名</option>
                            <option value="username">ユーザー名</option>
                            <option value="project">プロジェクト名</option>
                        </select>
                    </div>

                    <div class="input-group" x-show="nameType === 'japanese' || nameType === 'english'">
                        <label>性別:</label>
                        <select x-model="gender" class="number-input">
                            <option value="any">指定なし</option>
                            <option value="male">男性</option>
                            <option value="female">女性</option>
                        </select>
                    </div>

                    <div class="input-group" x-show="nameType === 'username' || nameType === 'project'">
                        <label>長さ:</label>
                        <select x-model="length" class="number-input">
                            <option value="short">短い</option>
                            <option value="medium">中</option>
                            <option value="long">長い</option>
                        </select>
                    </div>

                    <button @click="generate()" class="generate-btn">
                        📛 名前を生成
                    </button>

                    <div class="result">
                        <div class="result-label">生成された名前</div>
                        <div class="random-number" :class="{ 'fade-in': animating }" x-text="result || '?'"></div>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number" x-text="item.name"></span>
                                    <span class="time" x-text="item.type + ' - ' + item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- ビンゴカードタブ -->
                <div x-show="activeTab === 'bingo'" class="tab-content" x-data="bingoCard()">
                    <div class="input-group">
                        <label>カードサイズ:</label>
                        <select x-model="cardSize" class="number-input">
                            <option value="3">3 x 3</option>
                            <option value="4">4 x 4</option>
                            <option value="5">5 x 5</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>カードタイプ:</label>
                        <select x-model="cardType" class="number-input">
                            <option value="numbers">数字</option>
                            <option value="custom">カスタム項目</option>
                        </select>
                    </div>

                    <div class="input-group" x-show="cardType === 'custom'">
                        <label>カスタム項目（1行に1つ）:</label>
                        <textarea x-model="customItems" @input="saveCustomItems()" class="list-input" rows="8" placeholder="項目1&#10;項目2&#10;項目3&#10;..."></textarea>
                    </div>

                    <button @click="generate()" class="generate-btn">
                        🎬 ビンゴカードを生成
                    </button>

                    <div class="result" x-show="generatedCard">
                        <div class="result-label">ビンゴカード</div>
                        <div :class="'bingo-card size-' + cardSize" :class="{ 'fade-in': animating }">
                            <template x-for="(row, i) in generatedCard" :key="i">
                                <template x-for="(cell, j) in row" :key="j">
                                    <div class="bingo-cell" :class="{ 'free': cell === 'FREE' }" x-text="cell"></div>
                                </template>
                            </template>
                        </div>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <div style="max-height: 200px; overflow-y: auto;">
                            <template x-for="item in history" :key="item.id">
                                <div style="margin-bottom: 20px; padding: 15px; background: #f8f9fa; border-radius: 10px;">
                                    <div style="margin-bottom: 10px; font-size: 14px; color: #666;">
                                        <span x-text="item.size + 'x' + item.size + ' - ' + (item.type === 'numbers' ? '数字' : 'カスタム') + ' - ' + item.time"></span>
                                    </div>
                                    <div :class="'bingo-card size-' + item.size" style="transform: scale(0.7); transform-origin: left top;">
                                        <template x-for="(row, i) in item.card" :key="i">
                                            <template x-for="(cell, j) in row" :key="j">
                                                <div class="bingo-cell" :class="{ 'free': cell === 'FREE' }" x-text="cell"></div>
                                            </template>
                                        </template>
                                    </div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>

                <!-- Lorem Ipsumタブ -->
                <div x-show="activeTab === 'lorem'" class="tab-content" x-data="loremGenerator()">
                    <div class="input-group">
                        <label>言語:</label>
                        <select x-model="language" class="number-input">
                            <option value="japanese">日本語</option>
                            <option value="english">英語（Lorem Ipsum）</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>生成タイプ:</label>
                        <select x-model="generationType" class="number-input">
                            <option value="paragraphs">段落</option>
                            <option value="sentences">文</option>
                            <option value="words">単語</option>
                        </select>
                    </div>

                    <div class="input-group" x-show="generationType === 'paragraphs'">
                        <label>段落数: <span x-text="paragraphCount"></span></label>
                        <input type="range" x-model="paragraphCount" min="1" max="10" class="slider">
                    </div>

                    <div class="input-group" x-show="generationType === 'sentences'">
                        <label>文の数: <span x-text="sentenceCount"></span></label>
                        <input type="range" x-model="sentenceCount" min="1" max="20" class="slider">
                    </div>

                    <div class="input-group" x-show="generationType === 'words'">
                        <label>単語数: <span x-text="wordCount"></span></label>
                        <input type="range" x-model="wordCount" min="10" max="200" class="slider">
                    </div>

                    <button @click="generate()" class="generate-btn">
                        📝 テキストを生成
                    </button>

                    <div class="result" x-show="result">
                        <div class="result-label">生成されたテキスト</div>
                        <div style="text-align: left; white-space: pre-wrap; font-size: 14px; max-height: 300px; overflow-y: auto; padding: 15px; background: #f8f9fa; border-radius: 10px;" :class="{ 'fade-in': animating }" x-text="result"></div>
                        <button @click="copyText()" class="copy-btn" x-show="result">📋 コピー</button>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li @click="result = item.fullText" style="cursor: pointer;">
                                    <span class="number" x-text="item.text"></span>
                                    <span class="time" x-text="item.config + ' - ' + item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- 重み付き抽選タブ -->
                <div x-show="activeTab === 'weighted'" class="tab-content" x-data="weightedLottery()">
                    <div class="input-group">
                        <label>項目と重み（1行に1つ、形式: 項目名:重み）:</label>
                        <textarea x-model="items" @input="saveItems()" class="list-input" rows="8" placeholder="レア:1&#10;ノーマル:10&#10;コモン:50"></textarea>
                    </div>

                    <button @click="draw()" class="generate-btn">
                        ⚖️ 抽選する
                    </button>

                    <div class="result" x-show="result">
                        <div class="result-label">当選!</div>
                        <div class="random-number" :class="{ 'fade-in': animating }" x-text="result?.name"></div>
                        <div style="margin-top: 10px; color: #666;">
                            重み: <span x-text="result?.weight"></span> / 確率: <span x-text="result?.probability"></span>%
                        </div>
                    </div>

                    <div class="weighted-items">
                        <div style="font-weight: 600; margin-bottom: 10px;">確率一覧</div>
                        <template x-for="item in getProbabilityList()" :key="item.name">
                            <div class="weighted-item">
                                <span x-text="item.name"></span>
                                <span class="item-probability" x-text="item.probability + '%'"></span>
                            </div>
                        </template>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number" x-text="item.item + ' (' + item.probability + '%)'"></span>
                                    <span class="time" x-text="item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- ランダムタイマータブ -->
                <div x-show="activeTab === 'timer'" class="tab-content" x-data="randomTimer()">
                    <div class="input-group">
                        <label>時間範囲（分）:</label>
                        <div style="display: flex; gap: 10px;">
                            <input type="number" x-model="minMinutes" min="1" placeholder="最小" class="number-input">
                            <input type="number" x-model="maxMinutes" min="1" placeholder="最大" class="number-input">
                        </div>
                    </div>

                    <button @click="start()" class="generate-btn" x-show="!isRunning">
                        ⏱️ タイマー開始
                    </button>

                    <div class="result" x-show="isRunning">
                        <div class="result-label">残り時間</div>
                        <div class="timer-display" x-text="displayTime"></div>
                        <div class="timer-progress">
                            <div class="timer-progress-fill" :style="'width: ' + progressPercentage + '%'"></div>
                        </div>
                    </div>

                    <div class="timer-controls" x-show="isRunning">
                        <button @click="pause()" x-show="!isPaused" style="background: #ff9800; color: white;">⏸ 一時停止</button>
                        <button @click="resume()" x-show="isPaused" style="background: #4CAF50; color: white;">▶️ 再開</button>
                        <button @click="stop()" style="background: #f44336; color: white;">⏹ 停止</button>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number" x-text="item.duration"></span>
                                    <span class="time" x-text="item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- グラデーション生成器タブ -->
                <div x-show="activeTab === 'gradient'" class="tab-content" x-data="gradientGenerator()">
                    <div class="input-group">
                        <label>グラデーションタイプ:</label>
                        <select x-model="gradientType" class="number-input">
                            <option value="linear">線形</option>
                            <option value="radial">放射状</option>
                            <option value="conic">円錐形</option>
                        </select>
                    </div>

                    <div class="input-group">
                        <label>色の数: <span x-text="colorCount"></span></label>
                        <input type="range" x-model="colorCount" min="2" max="5" class="slider">
                    </div>

                    <div class="input-group" x-show="gradientType === 'linear' || gradientType === 'conic'">
                        <label>角度: <span x-text="angle"></span>度</label>
                        <input type="range" x-model="angle" min="0" max="360" class="slider">
                    </div>

                    <button @click="generate()" class="generate-btn">
                        🌈 グラデーションを生成
                    </button>

                    <div class="result" x-show="generatedGradient">
                        <div class="result-label">プレビュー</div>
                        <div class="gradient-preview" :style="generatedGradient?.preview" :class="{ 'fade-in': animating }"></div>
                        <div class="gradient-colors">
                            <template x-for="color in generatedGradient?.colors" :key="color">
                                <div class="gradient-color-item">
                                    <div class="gradient-color-box" :style="'background: ' + color"></div>
                                    <div style="font-size: 12px; font-family: monospace;" x-text="color"></div>
                                </div>
                            </template>
                        </div>
                        <div class="gradient-code" x-text="generatedGradient?.css"></div>
                        <div style="display: flex; gap: 10px; margin-top: 10px;">
                            <button @click="copyCSS(generatedGradient.css)" class="copy-btn" style="flex: 1;">📋 CSS</button>
                            <button @click="copySVG()" class="copy-btn" style="flex: 1;">📋 SVG</button>
                        </div>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <div style="max-height: 200px; overflow-y: auto;">
                            <template x-for="item in history" :key="item.id">
                                <div @click="generatedGradient = item.gradient" style="margin-bottom: 10px; padding: 10px; background: #f8f9fa; border-radius: 8px; cursor: pointer;">
                                    <div style="height: 50px; border-radius: 6px; margin-bottom: 8px;" :style="item.gradient.preview"></div>
                                    <div style="font-size: 12px; color: #666;" x-text="item.type + ' - ' + item.time"></div>
                                </div>
                            </template>
                        </div>
                    </div>
                </div>

                <!-- 座標ランダマイザータブ -->
                <div x-show="activeTab === 'coordinate'" class="tab-content" x-data="coordinateRandomizer()">
                    <div class="input-group">
                        <label>範囲:</label>
                        <select x-model="rangeType" @change="updateRange()" class="number-input">
                            <option value="world">世界全体</option>
                            <option value="japan">日本</option>
                            <option value="tokyo">東京</option>
                            <option value="usa">アメリカ</option>
                            <option value="europe">ヨーロッパ</option>
                            <option value="asia">アジア</option>
                            <option value="custom">カスタム</option>
                        </select>
                    </div>

                    <div x-show="rangeType === 'custom'">
                        <div class="input-group">
                            <label>緯度範囲:</label>
                            <div style="display: flex; gap: 10px;">
                                <input type="number" x-model="minLat" step="0.1" placeholder="最小" class="number-input">
                                <input type="number" x-model="maxLat" step="0.1" placeholder="最大" class="number-input">
                            </div>
                        </div>
                        <div class="input-group">
                            <label>経度範囲:</label>
                            <div style="display: flex; gap: 10px;">
                                <input type="number" x-model="minLng" step="0.1" placeholder="最小" class="number-input">
                                <input type="number" x-model="maxLng" step="0.1" placeholder="最大" class="number-input">
                            </div>
                        </div>
                    </div>

                    <button @click="generate()" class="generate-btn">
                        🗺️ 座標を生成
                    </button>

                    <div class="result" x-show="result">
                        <div class="result-label">生成された座標</div>
                        <div style="font-size: 1.5em; font-family: monospace; margin: 20px 0;" :class="{ 'fade-in': animating }" x-text="result?.formatted"></div>
                        <div style="display: flex; gap: 10px;">
                            <button @click="copyCoordinate()" class="copy-btn" style="flex: 1;">📋 コピー</button>
                            <button @click="openInMaps()" class="copy-btn" style="flex: 1; background: #4285f4;">🗺️ 地図で開く</button>
                        </div>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li @click="window.open(item.url, '_blank')" style="cursor: pointer;">
                                    <span class="number" x-text="item.coordinate"></span>
                                    <span class="time" x-text="item.range + ' - ' + item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>

                <!-- タスクピッカータブ -->
                <div x-show="activeTab === 'task'" class="tab-content" x-data="taskPicker()">
                    <div class="input-group">
                        <label>タスク（1行に1つ、形式: タスク名:優先度）:</label>
                        <textarea x-model="tasks" @input="saveTasks()" class="list-input" rows="8" placeholder="買い物に行く:高&#10;レポートを書く:中&#10;メールを返信:低"></textarea>
                    </div>

                    <div class="input-group">
                        <label>優先度フィルター:</label>
                        <select x-model="priorities" class="number-input">
                            <option value="all">全て</option>
                            <option value="high">高のみ</option>
                            <option value="medium">中のみ</option>
                            <option value="low">低のみ</option>
                        </select>
                    </div>

                    <button @click="pick()" class="generate-btn">
                        ✏️ タスクを選ぶ
                    </button>

                    <div class="result" x-show="result">
                        <div class="result-label">選ばれたタスク</div>
                        <div class="random-number" :class="{ 'fade-in': animating }">
                            <span x-text="getPriorityEmoji(result?.priority)"></span>
                            <span x-text="result?.name"></span>
                        </div>
                        <div style="margin-top: 15px; color: #666;">
                            優先度: <span :style="'color: ' + getPriorityColor(result?.priority)" x-text="result?.priority"></span>
                        </div>
                        <button @click="markComplete()" class="copy-btn" style="margin-top: 15px;">✅ 完了にする</button>
                    </div>

                    <div style="margin-top: 20px;">
                        <button @click="resetCompleted()" class="secondary-btn">🔄 完了タスクをリセット</button>
                    </div>

                    <div class="history-section">
                        <h3>履歴</h3>
                        <button @click="clearHistory()" class="clear-btn">履歴をクリア</button>
                        <ul class="history-list">
                            <template x-for="item in history" :key="item.id">
                                <li>
                                    <span class="number">
                                        <span x-text="getPriorityEmoji(item.priority)"></span>
                                        <span x-text="item.task"></span>
                                    </span>
                                    <span class="time" x-text="item.time"></span>
                                </li>
                            </template>
                        </ul>
                    </div>
                </div>
            </div>
        </main>

        <footer>
            <p class="install-prompt" id="installPrompt" style="display: none;">
                📱 このアプリをホーム画面に追加できます
                <button id="installBtn" class="install-btn">インストール</button>
            </p>
        </footer>
    </div>
    </div>

    <!-- 1. 先にコンポーネント関数を登録 -->
    <script src="js/utils/HistoryManager.js"></script>
    <script src="js/utils/URLStateManager.js"></script>
    <script src="js/utils/DataManager.js"></script>
    <script src="js/utils/ThemeManager.js"></script>
    <script src="js/utils/SpeechManager.js"></script>
    <script src="js/components/numberGenerator.js"></script>
    <script src="js/components/listSelector.js"></script>
    <script src="js/components/roulette.js"></script>
    <script src="js/components/diceRoller.js"></script>
    <script src="js/components/cardDraw.js"></script>
    <script src="js/components/colorPicker.js"></script>
    <script src="js/components/dateRandomizer.js"></script>
    <script src="js/components/passwordGenerator.js"></script>
    <script src="js/components/decisionTool.js"></script>
    <script src="js/components/shuffler.js"></script>
    <script src="js/components/lotteryBox.js"></script>
    <script src="js/components/coinFlip.js"></script>
    <script src="js/components/menuSuggester.js"></script>
    <script src="js/components/nameGenerator.js"></script>
    <script src="js/components/bingoCard.js"></script>
    <script src="js/components/loremGenerator.js"></script>
    <script src="js/components/weightedLottery.js"></script>
    <script src="js/components/randomTimer.js"></script>
    <script src="js/components/gradientGenerator.js"></script>
    <script src="js/components/coordinateRandomizer.js"></script>
    <script src="js/components/taskPicker.js"></script>
    <script src="js/main.js"></script>

    <!-- 2. 最後にAlpine.jsを読み込んで初期化 -->
    <script src="https://cdn.jsdelivr.net/npm/alpinejs@3.x.x/dist/cdn.min.js"></script>
</body>
</html>
